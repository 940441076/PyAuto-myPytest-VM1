{"uid":"ff91bd957d23084a","name":"test_export","fullName":"testcases.export.test_export.TestExport#test_export","historyId":"78d464d9c8503b21ab47f47bad7c8655","time":{"start":1689158561967,"stop":1689158590328,"duration":28361},"description":"测试导出","descriptionHtml":"<p>测试导出</p>\n","status":"failed","statusMessage":"AssertionError: assert False","statusTrace":"self = <pywinauto.application.WindowSpecification object at 0x0000023230661B10>\ncriteria = [{'app': <pywinauto.application.Application object at 0x0000023230649790>, 'backend': 'uia', 'best_match': '血管内断层成像系统'}, {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False}]\ntimeout = 5.0, retry_interval = 0.09\n\n    def __resolve_control(self, criteria, timeout=None, retry_interval=None):\n        \"\"\"\n        Find a control using criteria\n    \n        * **criteria** - a list that contains 1 or 2 dictionaries\n    \n             1st element is search criteria for the dialog\n    \n             2nd element is search criteria for a control of the dialog\n    \n        * **timeout** -  maximum length of time to try to find the controls (default 5)\n        * **retry_interval** - how long to wait between each retry (default .2)\n        \"\"\"\n        if timeout is None:\n            timeout = Timings.window_find_timeout\n        if retry_interval is None:\n            retry_interval = Timings.window_find_retry\n    \n        try:\n>           ctrl = wait_until_passes(\n                timeout,\n                retry_interval,\n                self.__get_ctrl,\n                (findwindows.ElementNotFoundError,\n                 findbestmatch.MatchError,\n                 controls.InvalidWindowHandle,\n                 controls.InvalidElement),\n                criteria)\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py:250: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\ntimeout = 5.0, retry_interval = 0.09\nfunc = <bound method WindowSpecification.__get_ctrl of <pywinauto.application.WindowSpecification object at 0x0000023230661B10>>\nexceptions = (<class 'pywinauto.findwindows.ElementNotFoundError'>, <class 'pywinauto.findbestmatch.MatchError'>, <class 'pywinauto.controls.hwndwrapper.InvalidWindowHandle'>, <class 'pywinauto.base_wrapper.InvalidElement'>)\nargs = ([{'app': <pywinauto.application.Application object at 0x0000023230649790>, 'backend': 'uia', 'best_match': '血管内断层成像系统'}, {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False}],)\nkwargs = {}, start = 20234.190998, time_left = -0.052211400001397124\nerr = TimeoutError()\n\n    def wait_until_passes(timeout,\n                          retry_interval,\n                          func,\n                          exceptions=(Exception),\n                          *args, **kwargs):\n        \"\"\"\n        Wait until ``func(*args, **kwargs)`` does not raise one of the exceptions\n    \n        * **timeout**  how long the function will try the function\n        * **retry_interval**  how long to wait between retries\n        * **func** the function that will be executed\n        * **exceptions**  list of exceptions to test against (default: Exception)\n        * **args** optional arguments to be passed to func when called\n        * **kwargs** optional keyword arguments to be passed to func when called\n    \n        Returns the return value of the function\n        If the operation times out then the original exception raised is in\n        the 'original_exception' attribute of the raised exception.\n    \n        e.g. ::\n    \n            try:\n                # wait a maximum of 10.5 seconds for the\n                # window to be found in increments of .5 of a second.\n                # P.int a message and re-raise the original exception if never found.\n                wait_until_passes(10.5, .5, self.Exists, (ElementNotFoundError))\n            except TimeoutError as e:\n                print(\"timed out\")\n                raise e.\n        \"\"\"\n        start = timestamp()\n    \n        # keep trying until the timeout is passed\n        while True:\n            try:\n                # Call the function with any arguments\n                func_val = func(*args, **kwargs)\n    \n                # if no exception is raised then we are finished\n                break\n    \n            # An exception was raised - so wait and try again\n            except exceptions as e:\n    \n                # find out how much of the time is left\n                time_left = timeout - (timestamp() - start)\n    \n                # if we have to wait some more\n                if time_left > 0:\n                    # wait either the retry_interval or else the amount of\n                    # time until the timeout expires (whichever is less)\n                    time.sleep(min(retry_interval, time_left))\n    \n                else:\n                    # Raise a TimeoutError - and put the original exception\n                    # inside it\n                    err = TimeoutError()\n                    err.original_exception = e\n>                   raise err\nE                   pywinauto.timings.TimeoutError\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\timings.py:458: TimeoutError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_export.TestExport object at 0x000002322EC18510>\n\n    @pytest.mark.test\n    def test_export(self):\n        allure.dynamic.description('测试导出')\n        try:\n            app = common_util.connect_application()\n            # common_util.del_devices_file()\n            common_util.del_all_patients()\n            for m in range(10):\n                common_util.new_patient(hospitalId='id{}'.format(m+1),patientName='name{}'.format(m+1))\n                with allure.step('6k:不同转速和距离'):\n                    # 6k转\n                    setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n>                   setting_btn.click_input()\n\ntestcases\\export\\test_export.py:33: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pywinauto.application.WindowSpecification object at 0x0000023230661B10>\nattr_name = 'click_input'\n\n    def __getattribute__(self, attr_name):\n        \"\"\"\n        Attribute access for this class\n    \n        If we already have criteria for both dialog and control then\n        resolve the control and return the requested attribute.\n    \n        If we have only criteria for the dialog but the attribute\n        requested is an attribute of DialogWrapper then resolve the\n        dialog and return the requested attribute.\n    \n        Otherwise delegate functionality to :func:`__getitem__` - which\n        sets the appropriate criteria for the control.\n        \"\"\"\n        allow_magic_lookup = object.__getattribute__(self, \"allow_magic_lookup\")  # Beware of recursions here!\n        if not allow_magic_lookup:\n            try:\n                return object.__getattribute__(self, attr_name)\n            except AttributeError:\n                wrapper_object = self.wrapper_object()\n                try:\n                    return getattr(wrapper_object, attr_name)\n                except AttributeError:\n                    message = (\n                        'Attribute \"%s\" exists neither on %s object nor on'\n                        'targeted %s element wrapper (typo? or set allow_magic_lookup to True?)' %\n                        (attr_name, self.__class__, wrapper_object.__class__))\n                    raise AttributeError(message)\n    \n        if attr_name in ['__dict__', '__members__', '__methods__', '__class__', '__name__']:\n            return object.__getattribute__(self, attr_name)\n    \n        if attr_name in dir(self.__class__):\n            return object.__getattribute__(self, attr_name)\n    \n        if attr_name in self.__dict__:\n            return self.__dict__[attr_name]\n    \n        # if we already have 2 levels of criteria (dlg, control)\n        # this third must be an attribute so resolve and get the\n        # attribute and return it\n        if len(self.criteria) >= 2:  # FIXME - this is surprising\n    \n>           ctrls = self.__resolve_control(self.criteria)\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py:379: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pywinauto.application.WindowSpecification object at 0x0000023230661B10>\ncriteria = [{'app': <pywinauto.application.Application object at 0x0000023230649790>, 'backend': 'uia', 'best_match': '血管内断层成像系统'}, {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False}]\ntimeout = 5.0, retry_interval = 0.09\n\n    def __resolve_control(self, criteria, timeout=None, retry_interval=None):\n        \"\"\"\n        Find a control using criteria\n    \n        * **criteria** - a list that contains 1 or 2 dictionaries\n    \n             1st element is search criteria for the dialog\n    \n             2nd element is search criteria for a control of the dialog\n    \n        * **timeout** -  maximum length of time to try to find the controls (default 5)\n        * **retry_interval** - how long to wait between each retry (default .2)\n        \"\"\"\n        if timeout is None:\n            timeout = Timings.window_find_timeout\n        if retry_interval is None:\n            retry_interval = Timings.window_find_retry\n    \n        try:\n            ctrl = wait_until_passes(\n                timeout,\n                retry_interval,\n                self.__get_ctrl,\n                (findwindows.ElementNotFoundError,\n                 findbestmatch.MatchError,\n                 controls.InvalidWindowHandle,\n                 controls.InvalidElement),\n                criteria)\n    \n        except TimeoutError as e:\n>           raise e.original_exception\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py:261: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\ntimeout = 5.0, retry_interval = 0.09\nfunc = <bound method WindowSpecification.__get_ctrl of <pywinauto.application.WindowSpecification object at 0x0000023230661B10>>\nexceptions = (<class 'pywinauto.findwindows.ElementNotFoundError'>, <class 'pywinauto.findbestmatch.MatchError'>, <class 'pywinauto.controls.hwndwrapper.InvalidWindowHandle'>, <class 'pywinauto.base_wrapper.InvalidElement'>)\nargs = ([{'app': <pywinauto.application.Application object at 0x0000023230649790>, 'backend': 'uia', 'best_match': '血管内断层成像系统'}, {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False}],)\nkwargs = {}, start = 20234.190998, time_left = -0.052211400001397124\nerr = TimeoutError()\n\n    def wait_until_passes(timeout,\n                          retry_interval,\n                          func,\n                          exceptions=(Exception),\n                          *args, **kwargs):\n        \"\"\"\n        Wait until ``func(*args, **kwargs)`` does not raise one of the exceptions\n    \n        * **timeout**  how long the function will try the function\n        * **retry_interval**  how long to wait between retries\n        * **func** the function that will be executed\n        * **exceptions**  list of exceptions to test against (default: Exception)\n        * **args** optional arguments to be passed to func when called\n        * **kwargs** optional keyword arguments to be passed to func when called\n    \n        Returns the return value of the function\n        If the operation times out then the original exception raised is in\n        the 'original_exception' attribute of the raised exception.\n    \n        e.g. ::\n    \n            try:\n                # wait a maximum of 10.5 seconds for the\n                # window to be found in increments of .5 of a second.\n                # P.int a message and re-raise the original exception if never found.\n                wait_until_passes(10.5, .5, self.Exists, (ElementNotFoundError))\n            except TimeoutError as e:\n                print(\"timed out\")\n                raise e.\n        \"\"\"\n        start = timestamp()\n    \n        # keep trying until the timeout is passed\n        while True:\n            try:\n                # Call the function with any arguments\n>               func_val = func(*args, **kwargs)\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\timings.py:436: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pywinauto.application.WindowSpecification object at 0x0000023230661B10>\ncriteria_ = [{'app': <pywinauto.application.Application object at 0x0000023230649790>, 'backend': 'uia', 'best_match': '血管内断层成像系统'}, {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False}]\n\n    def __get_ctrl(self, criteria_):\n        \"\"\"Get a control based on the various criteria\"\"\"\n        # make a copy of the criteria\n        criteria = [crit.copy() for crit in criteria_]\n        # find the dialog\n        if 'backend' not in criteria[0]:\n            criteria[0]['backend'] = self.backend.name\n        if self.app is not None:\n            # find_elements(...) accepts only \"process\" argument\n            criteria[0]['process'] = self.app.process\n            del criteria[0]['app']\n        dialog = self.backend.generic_wrapper_class(findwindows.find_element(**criteria[0]))\n    \n        ctrls = []\n        # if there is only criteria for a dialog then return it\n        if len(criteria) > 1:\n            # so there was criteria for a control, add the extra criteria\n            # that are required for child controls\n            previous_parent = dialog.element_info\n            for ctrl_criteria in criteria[1:]:\n                ctrl_criteria[\"top_level_only\"] = False\n                if \"parent\" not in ctrl_criteria:\n                    ctrl_criteria[\"parent\"] = previous_parent\n    \n                if isinstance(ctrl_criteria[\"parent\"], WindowSpecification):\n                    ctrl_criteria[\"parent\"] = ctrl_criteria[\"parent\"].wrapper_object()\n    \n                # resolve the control and return it\n                if 'backend' not in ctrl_criteria:\n                    ctrl_criteria['backend'] = self.backend.name\n>               ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py:222: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkwargs = {'auto_id': 'btnSetting', 'backend': 'uia', 'control_type': 'Button', 'parent': <uia_element_info.UIAElementInfo - '血管内光学干涉断层成像系统', Window, 721684>, ...}\nelements = []\n\n    def find_element(**kwargs):\n        \"\"\"\n        Call find_elements and ensure that only one element is returned\n    \n        Calls find_elements with exactly the same arguments as it is called with\n        so please see :py:func:`find_elements` for the full parameters description.\n        \"\"\"\n        elements = find_elements(**kwargs)\n    \n        if not elements:\n>           raise ElementNotFoundError(kwargs)\nE           pywinauto.findwindows.ElementNotFoundError: {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - '血管内光学干涉断层成像系统', Window, 721684>, 'backend': 'uia'}\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\findwindows.py:87: ElementNotFoundError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_export.TestExport object at 0x000002322EC18510>\n\n    @pytest.mark.test\n    def test_export(self):\n        allure.dynamic.description('测试导出')\n        try:\n            app = common_util.connect_application()\n            # common_util.del_devices_file()\n            common_util.del_all_patients()\n            for m in range(10):\n                common_util.new_patient(hospitalId='id{}'.format(m+1),patientName='name{}'.format(m+1))\n                with allure.step('6k:不同转速和距离'):\n                    # 6k转\n                    setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                    setting_btn.click_input()\n                    k6_btn = app['血管内断层成像系统'].child_window(title=\"6k转\", auto_id=\"rbRotateSpeed6000\",\n                                                                    control_type=\"RadioButton\", found_index=0)\n                    k6_btn.click()\n                    pull_len = app['血管内断层成像系统'].child_window(auto_id=\"comPullback\", control_type=\"ComboBox\")\n                    pull_len.select(0)\n                    content_len = pull_len.texts()\n                    for i in range(len(content_len)):\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                   control_type=\"Button\")\n                        if setting_close_btn.exists() == False:\n                            setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",\n                                                                                 control_type=\"Button\")\n                            setting_btn.click_input()\n                        pull_len.select(i)\n                        pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\",\n                                                                            control_type=\"ComboBox\")\n                        pull_speed.select(0)\n                        content_speed = pull_speed.texts()\n                        for j in range(len(content_speed)):\n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                       control_type=\"Button\")\n                            if setting_close_btn.exists() == False:\n                                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",\n                                                                                     control_type=\"Button\",\n                                                                                 found_index=0)\n                                setting_btn.click_input()\n                            pull_speed.select(j)\n                            time.sleep(1)\n                            common_util.screen_shot('距离/速度:{}-{}'.format(content_len[i], content_speed[j]))\n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                       control_type=\"Button\")\n                            setting_close_btn.click()\n                            time.sleep(1)\n                            scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            scan_btn.click()\n                            time.sleep(5)\n                            ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\", control_type=\"Button\")\n                            if ok_btn.exists():\n                                ok_btn.click()\n                            else:\n                                stop_btn = app['血管内断层成像系统'].child_window(auto_id=\"stopScan\",\n                                                                                  control_type=\"Button\")\n                                stop_btn.click()\n                            scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            scan_btn.click()\n                            time.sleep(5)\n                            ready_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            ready_btn.click()\n                            time.sleep(5)\n                            pullback_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\",\n                                                                                  control_type=\"Button\")\n                            pullback_btn.click()\n                            time.sleep(10)\n                            for k in range(15):\n                                export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",control_type=\"Button\")\n                                time.sleep(6)\n                                if export_btn.is_enabled():\n                                    time.sleep(1)\n                                    break\n                            export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",control_type=\"Button\")\n                            if export_btn.is_enabled():\n    \n                                random_num = random.randint(1, 31)\n                                if random_num % 2 == 0:\n                                    with allure.step('开始导出'):\n                                        export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",control_type=\"Button\")\n                                        export_btn.click()\n                                        time.sleep(1)\n                                        out_btn = app['血管内断层成像系统'].child_window(title=\"导出\", auto_id=\"btnOutput\",\n                                                                                         control_type=\"Button\").wait('enabled',timeout=5)\n                                        out_btn.click()\n                                        for k in range(100):\n                                            if k%2==0:\n                                                pyautogui.click(500,500)\n                                            else:\n                                                pyautogui.click(600, 600)\n                                        time.sleep(1)\n                                        common_util.screen_shot('截图')\n                                        ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                          control_type=\"Button\").wait(wait_for='exists',\n                                                                                                      timeout=100)\n                                        ok_btn.click()\n                                        time.sleep(1)\n                                        end_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\",control_type=\"Button\")\n                                        end_btn.click()\n                                        time.sleep(2)\n                                elif random_num % 3 == 0 or random_num % 5 == 0:\n                                    with allure.step('结束查看'):\n                                        end_btn = app['血管内断层成像系统'].child_window(auto_id=\"close\",\n                                                                                         control_type=\"Button\")\n                                        end_btn.click()\n    \n                                        time.sleep(3)\n                                    with allure.step('选中数据后，点击导出按钮'):\n                                        img_num = app['血管内断层成像系统'].child_window(auto_id=\"lstBox_Date\",\n                                                                                         control_type=\"List\")\n                                        img_num = int(img_num.texts()[0][2])-1\n                                        if img_num > 5:\n                                            for k in range(70):\n                                                mouse.scroll(coords=(500, 500), wheel_dist=-10)\n                                        check_mark = app['血管内断层成像系统'].child_window(auto_id=\"checkBox\",control_type=\"CheckBox\",found_index=img_num)\n                                        rect = check_mark.rectangle().mid_point()\n                                        mouse.click(coords=(rect.x, rect.y))\n                                        time.sleep(1)\n                                        export_btn = app['血管内断层成像系统'].child_window(title=\"导出\",control_type=\"Text\",found_index=0)\n                                        rect = export_btn.rectangle().mid_point()\n                                        mouse.click(coords=(rect.x, rect.y))\n                                        time.sleep(1)\n                                        next_btn = app['血管内断层成像系统'].child_window(title=\"下一步\",auto_id=\"btnOutput\",control_type=\"Button\")\n                                        next_btn.click()\n                                        time.sleep(1)\n                                        app['血管内断层成像系统'].child_window(title=\"导出\", auto_id=\"btnOutput\",\n                                                                               control_type=\"Button\").wait(\n                                            wait_for='enabled', timeout=100)\n                                        time.sleep(1)\n                                        out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                         auto_id=\"btnOutput\",\n                                                                                         control_type=\"Button\").wait('enabled',timeout=5)\n                                        out_btn.click()\n                                        for k in range(100):\n                                            if k % 2 == 0:\n                                                pyautogui.click(500, 500)\n                                            else:\n                                                pyautogui.click(600, 600)\n                                        time.sleep(1)\n                                        common_util.screen_shot('截图')\n                                        ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                          control_type=\"Button\").wait(wait_for='exists', timeout=100)\n                                        ok_btn.click()\n                                        time.sleep(1)\n                                        cancel_btn = app['血管内断层成像系统'].child_window(title=\"取消\",\n                                                                                            auto_id=\"btnCancel\",\n                                                                                            control_type=\"Button\")\n                                        cancel_btn.click()\n                                        time.sleep(1)\n                                        newOCT_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnAddOCT\", control_type=\"Button\")\n                                        newOCT_btn.click()\n                                        time.sleep(2)\n                                else:\n                                    end_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\",\n                                                                                     control_type=\"Button\")\n                                    end_btn.click()\n                                    time.sleep(2)\n                            else:\n                                with allure.step('lumen计算失败'):\n                                    end_btn = app['血管内断层成像系统'].child_window(auto_id=\"close\",\n                                                                                     control_type=\"Button\")\n                                    end_btn.click()\n    \n                                    time.sleep(3)\n                                with allure.step('选中数据后，点击导出按钮'):\n                                    img_num = app['血管内断层成像系统'].child_window(auto_id=\"lstBox_Date\",\n                                                                                     control_type=\"List\")\n                                    img_num = int(img_num.texts()[0][2]) - 1\n                                    if img_num > 5:\n                                        for k in range(70):\n                                            mouse.scroll(coords=(500, 500), wheel_dist=-10)\n                                    check_mark = app['血管内断层成像系统'].child_window(auto_id=\"checkBox\",\n                                                                                        control_type=\"CheckBox\",\n                                                                                        found_index=img_num)\n                                    rect = check_mark.rectangle().mid_point()\n                                    mouse.click(coords=(rect.x, rect.y))\n                                    time.sleep(1)\n                                    export_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                        control_type=\"Text\",\n                                                                                        found_index=0)\n                                    rect = export_btn.rectangle().mid_point()\n                                    mouse.click(coords=(rect.x, rect.y))\n                                    time.sleep(1)\n                                    next_btn = app['血管内断层成像系统'].child_window(title=\"下一步\",\n                                                                                      auto_id=\"btnOutput\",\n                                                                                      control_type=\"Button\")\n                                    next_btn.click()\n                                    time.sleep(1)\n                                    app['血管内断层成像系统'].child_window(title=\"导出\", auto_id=\"btnOutput\",\n                                                                           control_type=\"Button\").wait(\n                                        wait_for='enabled', timeout=100)\n                                    time.sleep(1)\n                                    out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                     auto_id=\"btnOutput\",\n                                                                                     control_type=\"Button\").wait(\n                                        'enabled', timeout=5)\n                                    out_btn.click()\n                                    for k in range(100):\n                                        if k % 2 == 0:\n                                            pyautogui.click(500, 500)\n                                        else:\n                                            pyautogui.click(600, 600)\n                                    time.sleep(1)\n                                    common_util.screen_shot('截图')\n                                    ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                      control_type=\"Button\").wait(wait_for='exists', timeout=100)\n                                    ok_btn.click()\n                                    time.sleep(1)\n                                    cancel_btn = app['血管内断层成像系统'].child_window(title=\"取消\",\n                                                                                        auto_id=\"btnCancel\",\n                                                                                        control_type=\"Button\")\n                                    cancel_btn.click()\n                                    time.sleep(1)\n                                    newOCT_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnAddOCT\",\n                                                                                        control_type=\"Button\")\n                                    newOCT_btn.click()\n                                    time.sleep(2)\n                            time.sleep(3)\n                with allure.step('12k:不同转速和距离'):\n                    k12 = common_util.read_systemInfo()\n                    if k12['K12'] == True:\n                        setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                        setting_btn.click_input()\n                        pull_len = app['血管内断层成像系统'].child_window(auto_id=\"comPullback\",control_type=\"ComboBox\")\n                        pull_len.select(0)\n                        k12_btn = app['血管内断层成像系统'].child_window(title=\"12k转\", auto_id=\"rbRotateSpeed12000\",\n                                                                         control_type=\"RadioButton\", found_index=0)\n                        k12_btn.click()\n                        content_len = pull_len.texts()\n                        for i in range(len(content_len)):\n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                       control_type=\"Button\")\n                            if setting_close_btn.exists() == False:\n                                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",\n                                                                                     control_type=\"Button\")\n                                setting_btn.click_input()\n                            pull_len.select(i)\n                            time.sleep(1)\n    \n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                       control_type=\"Button\")\n                            if setting_close_btn.exists() == False:\n                                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",\n                                                                                     control_type=\"Button\")\n                                setting_btn.click_input()\n                            pull_len.select(i)\n                            pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\",\n                                                                                control_type=\"ComboBox\")\n                            pull_speed.select(0)\n                            content_speed = pull_speed.texts()\n                            for j in range(len(content_speed)):\n                                setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                           control_type=\"Button\")\n                                if setting_close_btn.exists() == False:\n                                    setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",\n                                                                                         control_type=\"Button\",\n                                                                         found_index=0)\n                                    setting_btn.click_input()\n                                pull_speed.select(j)\n                                time.sleep(1)\n                                common_util.screen_shot('距离/速度:{}-{}'.format(content_len[i], content_speed[j]))\n                                setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                           control_type=\"Button\")\n                                setting_close_btn.click()\n                                scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\",\n                                                                                  control_type=\"Button\")\n                                scan_btn.click()\n                                time.sleep(5)\n                                ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                  control_type=\"Button\")\n                                if ok_btn.exists():\n                                    ok_btn.click()\n                                else:\n                                    stop_btn = app['血管内断层成像系统'].child_window(auto_id=\"stopScan\",\n                                                                                      control_type=\"Button\")\n                                    stop_btn.click()\n                                scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\",\n                                                                                  control_type=\"Button\")\n                                scan_btn.click()\n                                time.sleep(4)\n                                ready_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\",\n                                                                                   control_type=\"Button\")\n                                ready_btn.click()\n                                time.sleep(5)\n                                pullback_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\",\n                                                                                      control_type=\"Button\")\n                                pullback_btn.click()\n    \n                                if content_len[i]=='54mm' and content_speed[j]=='10mm/s':\n                                    time.sleep(30)\n                                else:\n                                    time.sleep(15)\n                                for k in range(15):\n                                    export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",\n                                                                                        control_type=\"Button\")\n                                    time.sleep(6)\n                                    if export_btn.is_enabled():\n                                        time.sleep(1)\n                                        break\n                                export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",\n                                                                                    control_type=\"Button\")\n                                if export_btn.is_enabled():\n    \n                                    random_num = random.randint(1, 31)\n                                    if random_num % 2 == 0:\n                                        with allure.step('开始导出'):\n                                            export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",\n                                                                                                control_type=\"Button\")\n                                            export_btn.click()\n                                            time.sleep(1)\n                                            out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                             auto_id=\"btnOutput\",\n                                                                                             control_type=\"Button\").wait(\n                                                'enabled', timeout=5)\n                                            out_btn.click()\n                                            for k in range(100):\n                                                if k % 2 == 0:\n                                                    pyautogui.click(500, 500)\n                                                else:\n                                                    pyautogui.click(600, 600)\n                                            time.sleep(1)\n                                            common_util.screen_shot('截图')\n                                            ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                              control_type=\"Button\").wait(\n                                                wait_for='exists',\n                                                timeout=100)\n                                            ok_btn.click()\n                                            time.sleep(1)\n                                            end_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\",\n                                                                                             control_type=\"Button\")\n                                            end_btn.click()\n                                            time.sleep(2)\n                                    elif random_num % 3 == 0 or random_num % 5 == 0:\n                                        with allure.step('结束查看'):\n                                            end_btn = app['血管内断层成像系统'].child_window(auto_id=\"close\",\n                                                                                             control_type=\"Button\")\n                                            end_btn.click()\n    \n                                            time.sleep(3)\n                                        with allure.step('选中数据后，点击导出按钮'):\n                                            img_num = app['血管内断层成像系统'].child_window(auto_id=\"lstBox_Date\",\n                                                                                             control_type=\"List\")\n                                            img_num = int(img_num.texts()[0][2]) - 1\n                                            if img_num > 5:\n                                                for k in range(70):\n                                                    mouse.scroll(coords=(500, 500), wheel_dist=-10)\n                                            check_mark = app['血管内断层成像系统'].child_window(auto_id=\"checkBox\",\n                                                                                                control_type=\"CheckBox\",\n                                                                                                found_index=img_num)\n                                            rect = check_mark.rectangle().mid_point()\n                                            mouse.click(coords=(rect.x, rect.y))\n                                            time.sleep(1)\n                                            export_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                                control_type=\"Text\",\n                                                                                                found_index=0)\n                                            rect = export_btn.rectangle().mid_point()\n                                            mouse.click(coords=(rect.x, rect.y))\n                                            time.sleep(1)\n                                            next_btn = app['血管内断层成像系统'].child_window(title=\"下一步\",\n                                                                                              auto_id=\"btnOutput\",\n                                                                                              control_type=\"Button\")\n                                            next_btn.click()\n                                            time.sleep(1)\n                                            app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                   auto_id=\"btnOutput\",\n                                                                                   control_type=\"Button\").wait(\n                                                wait_for='enabled', timeout=100)\n                                            time.sleep(1)\n                                            out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                             auto_id=\"btnOutput\",\n                                                                                             control_type=\"Button\").wait(\n                                                'enabled', timeout=5)\n                                            out_btn.click()\n                                            for k in range(100):\n                                                if k % 2 == 0:\n                                                    pyautogui.click(500, 500)\n                                                else:\n                                                    pyautogui.click(600, 600)\n                                            time.sleep(1)\n                                            common_util.screen_shot('截图')\n                                            ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                              control_type=\"Button\").wait(wait_for='exists', timeout=100)\n                                            ok_btn.click()\n                                            time.sleep(1)\n                                            cancel_btn = app['血管内断层成像系统'].child_window(title=\"取消\",\n                                                                                                auto_id=\"btnCancel\",\n                                                                                                control_type=\"Button\")\n                                            cancel_btn.click()\n                                            time.sleep(1)\n                                            newOCT_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnAddOCT\",\n                                                                                                control_type=\"Button\")\n                                            newOCT_btn.click()\n                                            time.sleep(2)\n                                    else:\n                                        end_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\",\n                                                                                         control_type=\"Button\")\n                                        end_btn.click()\n                                        time.sleep(2)\n                                else:\n                                    with allure.step('lumen计算失败'):\n                                        end_btn = app['血管内断层成像系统'].child_window(auto_id=\"close\",\n                                                                                         control_type=\"Button\")\n                                        end_btn.click()\n    \n                                        time.sleep(3)\n                                    with allure.step('选中数据后，点击导出按钮'):\n                                        img_num = app['血管内断层成像系统'].child_window(auto_id=\"lstBox_Date\",\n                                                                                         control_type=\"List\")\n                                        img_num = int(img_num.texts()[0][2]) - 1\n                                        if img_num > 5:\n                                            for k in range(70):\n                                                mouse.scroll(coords=(500, 500), wheel_dist=-10)\n                                        check_mark = app['血管内断层成像系统'].child_window(auto_id=\"checkBox\",\n                                                                                            control_type=\"CheckBox\",\n                                                                                            found_index=img_num)\n                                        rect = check_mark.rectangle().mid_point()\n                                        mouse.click(coords=(rect.x, rect.y))\n                                        time.sleep(1)\n                                        export_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                            control_type=\"Text\",\n                                                                                            found_index=0)\n                                        rect = export_btn.rectangle().mid_point()\n                                        mouse.click(coords=(rect.x, rect.y))\n                                        time.sleep(1)\n                                        next_btn = app['血管内断层成像系统'].child_window(title=\"下一步\",\n                                                                                          auto_id=\"btnOutput\",\n                                                                                          control_type=\"Button\")\n                                        next_btn.click()\n                                        time.sleep(1)\n                                        app['血管内断层成像系统'].child_window(title=\"导出\", auto_id=\"btnOutput\",\n                                                                               control_type=\"Button\").wait(\n                                            wait_for='enabled', timeout=100)\n                                        time.sleep(1)\n                                        out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                         auto_id=\"btnOutput\",\n                                                                                         control_type=\"Button\").wait(\n                                            'enabled', timeout=5)\n                                        out_btn.click()\n                                        for k in range(100):\n                                            if k % 2 == 0:\n                                                pyautogui.click(500, 500)\n                                            else:\n                                                pyautogui.click(600, 600)\n                                        time.sleep(1)\n                                        common_util.screen_shot('截图')\n                                        ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                          control_type=\"Button\").wait(wait_for='exists', timeout=100)\n                                        ok_btn.click()\n                                        time.sleep(1)\n                                        cancel_btn = app['血管内断层成像系统'].child_window(title=\"取消\",\n                                                                                            auto_id=\"btnCancel\",\n                                                                                            control_type=\"Button\")\n                                        cancel_btn.click()\n                                        time.sleep(1)\n                                        newOCT_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnAddOCT\",\n                                                                                            control_type=\"Button\")\n                                        newOCT_btn.click()\n                                        time.sleep(2)\n                                time.sleep(3)\n                common_util.back_patientListPage()\n                patient_list = app['血管内断层成像系统'].child_window(title=\"F_2.Models.PatientInfo\",\n                                                                      control_type=\"DataItem\", found_index=0)\n                patient_list.click_input()\n                time.sleep(2)\n                ok_btn = app['血管内断层成像系统'].child_window(title=\"确定\", auto_id=\"btnOk\", control_type=\"Button\")\n                ok_btn.click()\n                time.sleep(2)\n                with allure.step('选中最后一个数据后，点击导出按钮'):\n                    img_num = app['血管内断层成像系统'].child_window(auto_id=\"lstBox_Date\", control_type=\"List\")\n                    img_num = int(img_num.texts()[0][2])-1\n                    if img_num>5:\n                        for i in range(70):\n                            mouse.scroll(coords=(500, 500), wheel_dist=-10)\n                    check_mark = app['血管内断层成像系统'].child_window(auto_id=\"checkBox\",\n                                                                        control_type=\"CheckBox\",\n                                                                        found_index=img_num)\n    \n                    rect = check_mark.rectangle().mid_point()\n                    mouse.click(coords=(rect.x, rect.y))\n                    time.sleep(1)\n                    export_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                        control_type=\"Text\",\n                                                                        found_index=0)\n                    rect = export_btn.rectangle().mid_point()\n                    mouse.click(coords=(rect.x, rect.y))\n                    time.sleep(1)\n                    next_btn = app['血管内断层成像系统'].child_window(title=\"下一步\",\n                                                                      auto_id=\"btnOutput\",\n                                                                      control_type=\"Button\")\n                    next_btn.click()\n                    time.sleep(1)\n                    app['血管内断层成像系统'].child_window(title=\"导出\", auto_id=\"btnOutput\",\n                                                           control_type=\"Button\").wait(\n                        wait_for='enabled', timeout=100)\n                    time.sleep(1)\n                    out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                     auto_id=\"btnOutput\",\n                                                                     control_type=\"Button\").wait('enabled',timeout=5)\n                    out_btn.click()\n                    for k in range(100):\n                        if k % 2 == 0:\n                            pyautogui.click(500, 500)\n                        else:\n                            pyautogui.click(600, 600)\n                    time.sleep(1)\n                    common_util.screen_shot('截图')\n                    ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                      control_type=\"Button\").wait(wait_for='exists', timeout=100)\n                    ok_btn.click()\n                    time.sleep(1)\n                    cancel_btn = app['血管内断层成像系统'].child_window(title=\"取消\",\n                                                                        auto_id=\"btnCancel\",\n                                                                        control_type=\"Button\")\n                    cancel_btn.click()\n                    time.sleep(1)\n    \n            disk_list = []\n            for c in string.ascii_uppercase:\n                disk = c + ':'\n                if os.path.isdir(disk):\n                    disk_list.append(disk)\n            for i in range(len(disk_list)):\n                disk_info = win32api.GetVolumeInformation(disk_list[i] + '/')\n                if disk_info[0] == 'BossXU':\n                    usb_adress = disk_list[i] + '/*'\n                    files = glob.glob(usb_adress)\n            export_file = []\n            for i in range(len(files)):\n                if 'FSM_202' in files[i]:\n                    export_file.append(i)\n            with allure.step('导出次数{}'.format(len(export_file))):\n                common_util.add_text('导出次数：{}'.format(len(export_file)))\n        except Exception as e:\n            common_util.add_text(str(e))\n>           assert False\nE           assert False\n\ntestcases\\export\\test_export.py:554: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1689158561914,"stop":1689158561966,"duration":52},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"_verify_url","time":{"start":1689158561967,"stop":1689158561967,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"base_url","time":{"start":1689158561967,"stop":1689158561967,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"environ","time":{"start":1689158561967,"stop":1689158561967,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"testStage":{"description":"测试导出","status":"failed","statusMessage":"AssertionError: assert False","statusTrace":"self = <pywinauto.application.WindowSpecification object at 0x0000023230661B10>\ncriteria = [{'app': <pywinauto.application.Application object at 0x0000023230649790>, 'backend': 'uia', 'best_match': '血管内断层成像系统'}, {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False}]\ntimeout = 5.0, retry_interval = 0.09\n\n    def __resolve_control(self, criteria, timeout=None, retry_interval=None):\n        \"\"\"\n        Find a control using criteria\n    \n        * **criteria** - a list that contains 1 or 2 dictionaries\n    \n             1st element is search criteria for the dialog\n    \n             2nd element is search criteria for a control of the dialog\n    \n        * **timeout** -  maximum length of time to try to find the controls (default 5)\n        * **retry_interval** - how long to wait between each retry (default .2)\n        \"\"\"\n        if timeout is None:\n            timeout = Timings.window_find_timeout\n        if retry_interval is None:\n            retry_interval = Timings.window_find_retry\n    \n        try:\n>           ctrl = wait_until_passes(\n                timeout,\n                retry_interval,\n                self.__get_ctrl,\n                (findwindows.ElementNotFoundError,\n                 findbestmatch.MatchError,\n                 controls.InvalidWindowHandle,\n                 controls.InvalidElement),\n                criteria)\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py:250: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\ntimeout = 5.0, retry_interval = 0.09\nfunc = <bound method WindowSpecification.__get_ctrl of <pywinauto.application.WindowSpecification object at 0x0000023230661B10>>\nexceptions = (<class 'pywinauto.findwindows.ElementNotFoundError'>, <class 'pywinauto.findbestmatch.MatchError'>, <class 'pywinauto.controls.hwndwrapper.InvalidWindowHandle'>, <class 'pywinauto.base_wrapper.InvalidElement'>)\nargs = ([{'app': <pywinauto.application.Application object at 0x0000023230649790>, 'backend': 'uia', 'best_match': '血管内断层成像系统'}, {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False}],)\nkwargs = {}, start = 20234.190998, time_left = -0.052211400001397124\nerr = TimeoutError()\n\n    def wait_until_passes(timeout,\n                          retry_interval,\n                          func,\n                          exceptions=(Exception),\n                          *args, **kwargs):\n        \"\"\"\n        Wait until ``func(*args, **kwargs)`` does not raise one of the exceptions\n    \n        * **timeout**  how long the function will try the function\n        * **retry_interval**  how long to wait between retries\n        * **func** the function that will be executed\n        * **exceptions**  list of exceptions to test against (default: Exception)\n        * **args** optional arguments to be passed to func when called\n        * **kwargs** optional keyword arguments to be passed to func when called\n    \n        Returns the return value of the function\n        If the operation times out then the original exception raised is in\n        the 'original_exception' attribute of the raised exception.\n    \n        e.g. ::\n    \n            try:\n                # wait a maximum of 10.5 seconds for the\n                # window to be found in increments of .5 of a second.\n                # P.int a message and re-raise the original exception if never found.\n                wait_until_passes(10.5, .5, self.Exists, (ElementNotFoundError))\n            except TimeoutError as e:\n                print(\"timed out\")\n                raise e.\n        \"\"\"\n        start = timestamp()\n    \n        # keep trying until the timeout is passed\n        while True:\n            try:\n                # Call the function with any arguments\n                func_val = func(*args, **kwargs)\n    \n                # if no exception is raised then we are finished\n                break\n    \n            # An exception was raised - so wait and try again\n            except exceptions as e:\n    \n                # find out how much of the time is left\n                time_left = timeout - (timestamp() - start)\n    \n                # if we have to wait some more\n                if time_left > 0:\n                    # wait either the retry_interval or else the amount of\n                    # time until the timeout expires (whichever is less)\n                    time.sleep(min(retry_interval, time_left))\n    \n                else:\n                    # Raise a TimeoutError - and put the original exception\n                    # inside it\n                    err = TimeoutError()\n                    err.original_exception = e\n>                   raise err\nE                   pywinauto.timings.TimeoutError\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\timings.py:458: TimeoutError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_export.TestExport object at 0x000002322EC18510>\n\n    @pytest.mark.test\n    def test_export(self):\n        allure.dynamic.description('测试导出')\n        try:\n            app = common_util.connect_application()\n            # common_util.del_devices_file()\n            common_util.del_all_patients()\n            for m in range(10):\n                common_util.new_patient(hospitalId='id{}'.format(m+1),patientName='name{}'.format(m+1))\n                with allure.step('6k:不同转速和距离'):\n                    # 6k转\n                    setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n>                   setting_btn.click_input()\n\ntestcases\\export\\test_export.py:33: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pywinauto.application.WindowSpecification object at 0x0000023230661B10>\nattr_name = 'click_input'\n\n    def __getattribute__(self, attr_name):\n        \"\"\"\n        Attribute access for this class\n    \n        If we already have criteria for both dialog and control then\n        resolve the control and return the requested attribute.\n    \n        If we have only criteria for the dialog but the attribute\n        requested is an attribute of DialogWrapper then resolve the\n        dialog and return the requested attribute.\n    \n        Otherwise delegate functionality to :func:`__getitem__` - which\n        sets the appropriate criteria for the control.\n        \"\"\"\n        allow_magic_lookup = object.__getattribute__(self, \"allow_magic_lookup\")  # Beware of recursions here!\n        if not allow_magic_lookup:\n            try:\n                return object.__getattribute__(self, attr_name)\n            except AttributeError:\n                wrapper_object = self.wrapper_object()\n                try:\n                    return getattr(wrapper_object, attr_name)\n                except AttributeError:\n                    message = (\n                        'Attribute \"%s\" exists neither on %s object nor on'\n                        'targeted %s element wrapper (typo? or set allow_magic_lookup to True?)' %\n                        (attr_name, self.__class__, wrapper_object.__class__))\n                    raise AttributeError(message)\n    \n        if attr_name in ['__dict__', '__members__', '__methods__', '__class__', '__name__']:\n            return object.__getattribute__(self, attr_name)\n    \n        if attr_name in dir(self.__class__):\n            return object.__getattribute__(self, attr_name)\n    \n        if attr_name in self.__dict__:\n            return self.__dict__[attr_name]\n    \n        # if we already have 2 levels of criteria (dlg, control)\n        # this third must be an attribute so resolve and get the\n        # attribute and return it\n        if len(self.criteria) >= 2:  # FIXME - this is surprising\n    \n>           ctrls = self.__resolve_control(self.criteria)\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py:379: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pywinauto.application.WindowSpecification object at 0x0000023230661B10>\ncriteria = [{'app': <pywinauto.application.Application object at 0x0000023230649790>, 'backend': 'uia', 'best_match': '血管内断层成像系统'}, {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False}]\ntimeout = 5.0, retry_interval = 0.09\n\n    def __resolve_control(self, criteria, timeout=None, retry_interval=None):\n        \"\"\"\n        Find a control using criteria\n    \n        * **criteria** - a list that contains 1 or 2 dictionaries\n    \n             1st element is search criteria for the dialog\n    \n             2nd element is search criteria for a control of the dialog\n    \n        * **timeout** -  maximum length of time to try to find the controls (default 5)\n        * **retry_interval** - how long to wait between each retry (default .2)\n        \"\"\"\n        if timeout is None:\n            timeout = Timings.window_find_timeout\n        if retry_interval is None:\n            retry_interval = Timings.window_find_retry\n    \n        try:\n            ctrl = wait_until_passes(\n                timeout,\n                retry_interval,\n                self.__get_ctrl,\n                (findwindows.ElementNotFoundError,\n                 findbestmatch.MatchError,\n                 controls.InvalidWindowHandle,\n                 controls.InvalidElement),\n                criteria)\n    \n        except TimeoutError as e:\n>           raise e.original_exception\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py:261: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\ntimeout = 5.0, retry_interval = 0.09\nfunc = <bound method WindowSpecification.__get_ctrl of <pywinauto.application.WindowSpecification object at 0x0000023230661B10>>\nexceptions = (<class 'pywinauto.findwindows.ElementNotFoundError'>, <class 'pywinauto.findbestmatch.MatchError'>, <class 'pywinauto.controls.hwndwrapper.InvalidWindowHandle'>, <class 'pywinauto.base_wrapper.InvalidElement'>)\nargs = ([{'app': <pywinauto.application.Application object at 0x0000023230649790>, 'backend': 'uia', 'best_match': '血管内断层成像系统'}, {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False}],)\nkwargs = {}, start = 20234.190998, time_left = -0.052211400001397124\nerr = TimeoutError()\n\n    def wait_until_passes(timeout,\n                          retry_interval,\n                          func,\n                          exceptions=(Exception),\n                          *args, **kwargs):\n        \"\"\"\n        Wait until ``func(*args, **kwargs)`` does not raise one of the exceptions\n    \n        * **timeout**  how long the function will try the function\n        * **retry_interval**  how long to wait between retries\n        * **func** the function that will be executed\n        * **exceptions**  list of exceptions to test against (default: Exception)\n        * **args** optional arguments to be passed to func when called\n        * **kwargs** optional keyword arguments to be passed to func when called\n    \n        Returns the return value of the function\n        If the operation times out then the original exception raised is in\n        the 'original_exception' attribute of the raised exception.\n    \n        e.g. ::\n    \n            try:\n                # wait a maximum of 10.5 seconds for the\n                # window to be found in increments of .5 of a second.\n                # P.int a message and re-raise the original exception if never found.\n                wait_until_passes(10.5, .5, self.Exists, (ElementNotFoundError))\n            except TimeoutError as e:\n                print(\"timed out\")\n                raise e.\n        \"\"\"\n        start = timestamp()\n    \n        # keep trying until the timeout is passed\n        while True:\n            try:\n                # Call the function with any arguments\n>               func_val = func(*args, **kwargs)\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\timings.py:436: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pywinauto.application.WindowSpecification object at 0x0000023230661B10>\ncriteria_ = [{'app': <pywinauto.application.Application object at 0x0000023230649790>, 'backend': 'uia', 'best_match': '血管内断层成像系统'}, {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False}]\n\n    def __get_ctrl(self, criteria_):\n        \"\"\"Get a control based on the various criteria\"\"\"\n        # make a copy of the criteria\n        criteria = [crit.copy() for crit in criteria_]\n        # find the dialog\n        if 'backend' not in criteria[0]:\n            criteria[0]['backend'] = self.backend.name\n        if self.app is not None:\n            # find_elements(...) accepts only \"process\" argument\n            criteria[0]['process'] = self.app.process\n            del criteria[0]['app']\n        dialog = self.backend.generic_wrapper_class(findwindows.find_element(**criteria[0]))\n    \n        ctrls = []\n        # if there is only criteria for a dialog then return it\n        if len(criteria) > 1:\n            # so there was criteria for a control, add the extra criteria\n            # that are required for child controls\n            previous_parent = dialog.element_info\n            for ctrl_criteria in criteria[1:]:\n                ctrl_criteria[\"top_level_only\"] = False\n                if \"parent\" not in ctrl_criteria:\n                    ctrl_criteria[\"parent\"] = previous_parent\n    \n                if isinstance(ctrl_criteria[\"parent\"], WindowSpecification):\n                    ctrl_criteria[\"parent\"] = ctrl_criteria[\"parent\"].wrapper_object()\n    \n                # resolve the control and return it\n                if 'backend' not in ctrl_criteria:\n                    ctrl_criteria['backend'] = self.backend.name\n>               ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py:222: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkwargs = {'auto_id': 'btnSetting', 'backend': 'uia', 'control_type': 'Button', 'parent': <uia_element_info.UIAElementInfo - '血管内光学干涉断层成像系统', Window, 721684>, ...}\nelements = []\n\n    def find_element(**kwargs):\n        \"\"\"\n        Call find_elements and ensure that only one element is returned\n    \n        Calls find_elements with exactly the same arguments as it is called with\n        so please see :py:func:`find_elements` for the full parameters description.\n        \"\"\"\n        elements = find_elements(**kwargs)\n    \n        if not elements:\n>           raise ElementNotFoundError(kwargs)\nE           pywinauto.findwindows.ElementNotFoundError: {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - '血管内光学干涉断层成像系统', Window, 721684>, 'backend': 'uia'}\n\nC:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\findwindows.py:87: ElementNotFoundError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_export.TestExport object at 0x000002322EC18510>\n\n    @pytest.mark.test\n    def test_export(self):\n        allure.dynamic.description('测试导出')\n        try:\n            app = common_util.connect_application()\n            # common_util.del_devices_file()\n            common_util.del_all_patients()\n            for m in range(10):\n                common_util.new_patient(hospitalId='id{}'.format(m+1),patientName='name{}'.format(m+1))\n                with allure.step('6k:不同转速和距离'):\n                    # 6k转\n                    setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                    setting_btn.click_input()\n                    k6_btn = app['血管内断层成像系统'].child_window(title=\"6k转\", auto_id=\"rbRotateSpeed6000\",\n                                                                    control_type=\"RadioButton\", found_index=0)\n                    k6_btn.click()\n                    pull_len = app['血管内断层成像系统'].child_window(auto_id=\"comPullback\", control_type=\"ComboBox\")\n                    pull_len.select(0)\n                    content_len = pull_len.texts()\n                    for i in range(len(content_len)):\n                        setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                   control_type=\"Button\")\n                        if setting_close_btn.exists() == False:\n                            setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",\n                                                                                 control_type=\"Button\")\n                            setting_btn.click_input()\n                        pull_len.select(i)\n                        pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\",\n                                                                            control_type=\"ComboBox\")\n                        pull_speed.select(0)\n                        content_speed = pull_speed.texts()\n                        for j in range(len(content_speed)):\n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                       control_type=\"Button\")\n                            if setting_close_btn.exists() == False:\n                                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",\n                                                                                     control_type=\"Button\",\n                                                                                 found_index=0)\n                                setting_btn.click_input()\n                            pull_speed.select(j)\n                            time.sleep(1)\n                            common_util.screen_shot('距离/速度:{}-{}'.format(content_len[i], content_speed[j]))\n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                       control_type=\"Button\")\n                            setting_close_btn.click()\n                            time.sleep(1)\n                            scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            scan_btn.click()\n                            time.sleep(5)\n                            ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\", control_type=\"Button\")\n                            if ok_btn.exists():\n                                ok_btn.click()\n                            else:\n                                stop_btn = app['血管内断层成像系统'].child_window(auto_id=\"stopScan\",\n                                                                                  control_type=\"Button\")\n                                stop_btn.click()\n                            scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            scan_btn.click()\n                            time.sleep(5)\n                            ready_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\", control_type=\"Button\")\n                            ready_btn.click()\n                            time.sleep(5)\n                            pullback_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\",\n                                                                                  control_type=\"Button\")\n                            pullback_btn.click()\n                            time.sleep(10)\n                            for k in range(15):\n                                export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",control_type=\"Button\")\n                                time.sleep(6)\n                                if export_btn.is_enabled():\n                                    time.sleep(1)\n                                    break\n                            export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",control_type=\"Button\")\n                            if export_btn.is_enabled():\n    \n                                random_num = random.randint(1, 31)\n                                if random_num % 2 == 0:\n                                    with allure.step('开始导出'):\n                                        export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",control_type=\"Button\")\n                                        export_btn.click()\n                                        time.sleep(1)\n                                        out_btn = app['血管内断层成像系统'].child_window(title=\"导出\", auto_id=\"btnOutput\",\n                                                                                         control_type=\"Button\").wait('enabled',timeout=5)\n                                        out_btn.click()\n                                        for k in range(100):\n                                            if k%2==0:\n                                                pyautogui.click(500,500)\n                                            else:\n                                                pyautogui.click(600, 600)\n                                        time.sleep(1)\n                                        common_util.screen_shot('截图')\n                                        ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                          control_type=\"Button\").wait(wait_for='exists',\n                                                                                                      timeout=100)\n                                        ok_btn.click()\n                                        time.sleep(1)\n                                        end_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\",control_type=\"Button\")\n                                        end_btn.click()\n                                        time.sleep(2)\n                                elif random_num % 3 == 0 or random_num % 5 == 0:\n                                    with allure.step('结束查看'):\n                                        end_btn = app['血管内断层成像系统'].child_window(auto_id=\"close\",\n                                                                                         control_type=\"Button\")\n                                        end_btn.click()\n    \n                                        time.sleep(3)\n                                    with allure.step('选中数据后，点击导出按钮'):\n                                        img_num = app['血管内断层成像系统'].child_window(auto_id=\"lstBox_Date\",\n                                                                                         control_type=\"List\")\n                                        img_num = int(img_num.texts()[0][2])-1\n                                        if img_num > 5:\n                                            for k in range(70):\n                                                mouse.scroll(coords=(500, 500), wheel_dist=-10)\n                                        check_mark = app['血管内断层成像系统'].child_window(auto_id=\"checkBox\",control_type=\"CheckBox\",found_index=img_num)\n                                        rect = check_mark.rectangle().mid_point()\n                                        mouse.click(coords=(rect.x, rect.y))\n                                        time.sleep(1)\n                                        export_btn = app['血管内断层成像系统'].child_window(title=\"导出\",control_type=\"Text\",found_index=0)\n                                        rect = export_btn.rectangle().mid_point()\n                                        mouse.click(coords=(rect.x, rect.y))\n                                        time.sleep(1)\n                                        next_btn = app['血管内断层成像系统'].child_window(title=\"下一步\",auto_id=\"btnOutput\",control_type=\"Button\")\n                                        next_btn.click()\n                                        time.sleep(1)\n                                        app['血管内断层成像系统'].child_window(title=\"导出\", auto_id=\"btnOutput\",\n                                                                               control_type=\"Button\").wait(\n                                            wait_for='enabled', timeout=100)\n                                        time.sleep(1)\n                                        out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                         auto_id=\"btnOutput\",\n                                                                                         control_type=\"Button\").wait('enabled',timeout=5)\n                                        out_btn.click()\n                                        for k in range(100):\n                                            if k % 2 == 0:\n                                                pyautogui.click(500, 500)\n                                            else:\n                                                pyautogui.click(600, 600)\n                                        time.sleep(1)\n                                        common_util.screen_shot('截图')\n                                        ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                          control_type=\"Button\").wait(wait_for='exists', timeout=100)\n                                        ok_btn.click()\n                                        time.sleep(1)\n                                        cancel_btn = app['血管内断层成像系统'].child_window(title=\"取消\",\n                                                                                            auto_id=\"btnCancel\",\n                                                                                            control_type=\"Button\")\n                                        cancel_btn.click()\n                                        time.sleep(1)\n                                        newOCT_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnAddOCT\", control_type=\"Button\")\n                                        newOCT_btn.click()\n                                        time.sleep(2)\n                                else:\n                                    end_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\",\n                                                                                     control_type=\"Button\")\n                                    end_btn.click()\n                                    time.sleep(2)\n                            else:\n                                with allure.step('lumen计算失败'):\n                                    end_btn = app['血管内断层成像系统'].child_window(auto_id=\"close\",\n                                                                                     control_type=\"Button\")\n                                    end_btn.click()\n    \n                                    time.sleep(3)\n                                with allure.step('选中数据后，点击导出按钮'):\n                                    img_num = app['血管内断层成像系统'].child_window(auto_id=\"lstBox_Date\",\n                                                                                     control_type=\"List\")\n                                    img_num = int(img_num.texts()[0][2]) - 1\n                                    if img_num > 5:\n                                        for k in range(70):\n                                            mouse.scroll(coords=(500, 500), wheel_dist=-10)\n                                    check_mark = app['血管内断层成像系统'].child_window(auto_id=\"checkBox\",\n                                                                                        control_type=\"CheckBox\",\n                                                                                        found_index=img_num)\n                                    rect = check_mark.rectangle().mid_point()\n                                    mouse.click(coords=(rect.x, rect.y))\n                                    time.sleep(1)\n                                    export_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                        control_type=\"Text\",\n                                                                                        found_index=0)\n                                    rect = export_btn.rectangle().mid_point()\n                                    mouse.click(coords=(rect.x, rect.y))\n                                    time.sleep(1)\n                                    next_btn = app['血管内断层成像系统'].child_window(title=\"下一步\",\n                                                                                      auto_id=\"btnOutput\",\n                                                                                      control_type=\"Button\")\n                                    next_btn.click()\n                                    time.sleep(1)\n                                    app['血管内断层成像系统'].child_window(title=\"导出\", auto_id=\"btnOutput\",\n                                                                           control_type=\"Button\").wait(\n                                        wait_for='enabled', timeout=100)\n                                    time.sleep(1)\n                                    out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                     auto_id=\"btnOutput\",\n                                                                                     control_type=\"Button\").wait(\n                                        'enabled', timeout=5)\n                                    out_btn.click()\n                                    for k in range(100):\n                                        if k % 2 == 0:\n                                            pyautogui.click(500, 500)\n                                        else:\n                                            pyautogui.click(600, 600)\n                                    time.sleep(1)\n                                    common_util.screen_shot('截图')\n                                    ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                      control_type=\"Button\").wait(wait_for='exists', timeout=100)\n                                    ok_btn.click()\n                                    time.sleep(1)\n                                    cancel_btn = app['血管内断层成像系统'].child_window(title=\"取消\",\n                                                                                        auto_id=\"btnCancel\",\n                                                                                        control_type=\"Button\")\n                                    cancel_btn.click()\n                                    time.sleep(1)\n                                    newOCT_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnAddOCT\",\n                                                                                        control_type=\"Button\")\n                                    newOCT_btn.click()\n                                    time.sleep(2)\n                            time.sleep(3)\n                with allure.step('12k:不同转速和距离'):\n                    k12 = common_util.read_systemInfo()\n                    if k12['K12'] == True:\n                        setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\", control_type=\"Button\")\n                        setting_btn.click_input()\n                        pull_len = app['血管内断层成像系统'].child_window(auto_id=\"comPullback\",control_type=\"ComboBox\")\n                        pull_len.select(0)\n                        k12_btn = app['血管内断层成像系统'].child_window(title=\"12k转\", auto_id=\"rbRotateSpeed12000\",\n                                                                         control_type=\"RadioButton\", found_index=0)\n                        k12_btn.click()\n                        content_len = pull_len.texts()\n                        for i in range(len(content_len)):\n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                       control_type=\"Button\")\n                            if setting_close_btn.exists() == False:\n                                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",\n                                                                                     control_type=\"Button\")\n                                setting_btn.click_input()\n                            pull_len.select(i)\n                            time.sleep(1)\n    \n                            setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                       control_type=\"Button\")\n                            if setting_close_btn.exists() == False:\n                                setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",\n                                                                                     control_type=\"Button\")\n                                setting_btn.click_input()\n                            pull_len.select(i)\n                            pull_speed = app['血管内断层成像系统'].child_window(auto_id=\"comPullBackSped\",\n                                                                                control_type=\"ComboBox\")\n                            pull_speed.select(0)\n                            content_speed = pull_speed.texts()\n                            for j in range(len(content_speed)):\n                                setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                           control_type=\"Button\")\n                                if setting_close_btn.exists() == False:\n                                    setting_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnSetting\",\n                                                                                         control_type=\"Button\",\n                                                                         found_index=0)\n                                    setting_btn.click_input()\n                                pull_speed.select(j)\n                                time.sleep(1)\n                                common_util.screen_shot('距离/速度:{}-{}'.format(content_len[i], content_speed[j]))\n                                setting_close_btn = app['血管内断层成像系统'].child_window(auto_id=\"closeSetting\",\n                                                                                           control_type=\"Button\")\n                                setting_close_btn.click()\n                                scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\",\n                                                                                  control_type=\"Button\")\n                                scan_btn.click()\n                                time.sleep(5)\n                                ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                  control_type=\"Button\")\n                                if ok_btn.exists():\n                                    ok_btn.click()\n                                else:\n                                    stop_btn = app['血管内断层成像系统'].child_window(auto_id=\"stopScan\",\n                                                                                      control_type=\"Button\")\n                                    stop_btn.click()\n                                scan_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\",\n                                                                                  control_type=\"Button\")\n                                scan_btn.click()\n                                time.sleep(4)\n                                ready_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\",\n                                                                                   control_type=\"Button\")\n                                ready_btn.click()\n                                time.sleep(5)\n                                pullback_btn = app['血管内断层成像系统'].child_window(auto_id=\"staScan\",\n                                                                                      control_type=\"Button\")\n                                pullback_btn.click()\n    \n                                if content_len[i]=='54mm' and content_speed[j]=='10mm/s':\n                                    time.sleep(30)\n                                else:\n                                    time.sleep(15)\n                                for k in range(15):\n                                    export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",\n                                                                                        control_type=\"Button\")\n                                    time.sleep(6)\n                                    if export_btn.is_enabled():\n                                        time.sleep(1)\n                                        break\n                                export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",\n                                                                                    control_type=\"Button\")\n                                if export_btn.is_enabled():\n    \n                                    random_num = random.randint(1, 31)\n                                    if random_num % 2 == 0:\n                                        with allure.step('开始导出'):\n                                            export_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnOutPut\",\n                                                                                                control_type=\"Button\")\n                                            export_btn.click()\n                                            time.sleep(1)\n                                            out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                             auto_id=\"btnOutput\",\n                                                                                             control_type=\"Button\").wait(\n                                                'enabled', timeout=5)\n                                            out_btn.click()\n                                            for k in range(100):\n                                                if k % 2 == 0:\n                                                    pyautogui.click(500, 500)\n                                                else:\n                                                    pyautogui.click(600, 600)\n                                            time.sleep(1)\n                                            common_util.screen_shot('截图')\n                                            ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                              control_type=\"Button\").wait(\n                                                wait_for='exists',\n                                                timeout=100)\n                                            ok_btn.click()\n                                            time.sleep(1)\n                                            end_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\",\n                                                                                             control_type=\"Button\")\n                                            end_btn.click()\n                                            time.sleep(2)\n                                    elif random_num % 3 == 0 or random_num % 5 == 0:\n                                        with allure.step('结束查看'):\n                                            end_btn = app['血管内断层成像系统'].child_window(auto_id=\"close\",\n                                                                                             control_type=\"Button\")\n                                            end_btn.click()\n    \n                                            time.sleep(3)\n                                        with allure.step('选中数据后，点击导出按钮'):\n                                            img_num = app['血管内断层成像系统'].child_window(auto_id=\"lstBox_Date\",\n                                                                                             control_type=\"List\")\n                                            img_num = int(img_num.texts()[0][2]) - 1\n                                            if img_num > 5:\n                                                for k in range(70):\n                                                    mouse.scroll(coords=(500, 500), wheel_dist=-10)\n                                            check_mark = app['血管内断层成像系统'].child_window(auto_id=\"checkBox\",\n                                                                                                control_type=\"CheckBox\",\n                                                                                                found_index=img_num)\n                                            rect = check_mark.rectangle().mid_point()\n                                            mouse.click(coords=(rect.x, rect.y))\n                                            time.sleep(1)\n                                            export_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                                control_type=\"Text\",\n                                                                                                found_index=0)\n                                            rect = export_btn.rectangle().mid_point()\n                                            mouse.click(coords=(rect.x, rect.y))\n                                            time.sleep(1)\n                                            next_btn = app['血管内断层成像系统'].child_window(title=\"下一步\",\n                                                                                              auto_id=\"btnOutput\",\n                                                                                              control_type=\"Button\")\n                                            next_btn.click()\n                                            time.sleep(1)\n                                            app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                   auto_id=\"btnOutput\",\n                                                                                   control_type=\"Button\").wait(\n                                                wait_for='enabled', timeout=100)\n                                            time.sleep(1)\n                                            out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                             auto_id=\"btnOutput\",\n                                                                                             control_type=\"Button\").wait(\n                                                'enabled', timeout=5)\n                                            out_btn.click()\n                                            for k in range(100):\n                                                if k % 2 == 0:\n                                                    pyautogui.click(500, 500)\n                                                else:\n                                                    pyautogui.click(600, 600)\n                                            time.sleep(1)\n                                            common_util.screen_shot('截图')\n                                            ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                              control_type=\"Button\").wait(wait_for='exists', timeout=100)\n                                            ok_btn.click()\n                                            time.sleep(1)\n                                            cancel_btn = app['血管内断层成像系统'].child_window(title=\"取消\",\n                                                                                                auto_id=\"btnCancel\",\n                                                                                                control_type=\"Button\")\n                                            cancel_btn.click()\n                                            time.sleep(1)\n                                            newOCT_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnAddOCT\",\n                                                                                                control_type=\"Button\")\n                                            newOCT_btn.click()\n                                            time.sleep(2)\n                                    else:\n                                        end_btn = app['血管内断层成像系统'].child_window(auto_id=\"addOCT\",\n                                                                                         control_type=\"Button\")\n                                        end_btn.click()\n                                        time.sleep(2)\n                                else:\n                                    with allure.step('lumen计算失败'):\n                                        end_btn = app['血管内断层成像系统'].child_window(auto_id=\"close\",\n                                                                                         control_type=\"Button\")\n                                        end_btn.click()\n    \n                                        time.sleep(3)\n                                    with allure.step('选中数据后，点击导出按钮'):\n                                        img_num = app['血管内断层成像系统'].child_window(auto_id=\"lstBox_Date\",\n                                                                                         control_type=\"List\")\n                                        img_num = int(img_num.texts()[0][2]) - 1\n                                        if img_num > 5:\n                                            for k in range(70):\n                                                mouse.scroll(coords=(500, 500), wheel_dist=-10)\n                                        check_mark = app['血管内断层成像系统'].child_window(auto_id=\"checkBox\",\n                                                                                            control_type=\"CheckBox\",\n                                                                                            found_index=img_num)\n                                        rect = check_mark.rectangle().mid_point()\n                                        mouse.click(coords=(rect.x, rect.y))\n                                        time.sleep(1)\n                                        export_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                            control_type=\"Text\",\n                                                                                            found_index=0)\n                                        rect = export_btn.rectangle().mid_point()\n                                        mouse.click(coords=(rect.x, rect.y))\n                                        time.sleep(1)\n                                        next_btn = app['血管内断层成像系统'].child_window(title=\"下一步\",\n                                                                                          auto_id=\"btnOutput\",\n                                                                                          control_type=\"Button\")\n                                        next_btn.click()\n                                        time.sleep(1)\n                                        app['血管内断层成像系统'].child_window(title=\"导出\", auto_id=\"btnOutput\",\n                                                                               control_type=\"Button\").wait(\n                                            wait_for='enabled', timeout=100)\n                                        time.sleep(1)\n                                        out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                                         auto_id=\"btnOutput\",\n                                                                                         control_type=\"Button\").wait(\n                                            'enabled', timeout=5)\n                                        out_btn.click()\n                                        for k in range(100):\n                                            if k % 2 == 0:\n                                                pyautogui.click(500, 500)\n                                            else:\n                                                pyautogui.click(600, 600)\n                                        time.sleep(1)\n                                        common_util.screen_shot('截图')\n                                        ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                                          control_type=\"Button\").wait(wait_for='exists', timeout=100)\n                                        ok_btn.click()\n                                        time.sleep(1)\n                                        cancel_btn = app['血管内断层成像系统'].child_window(title=\"取消\",\n                                                                                            auto_id=\"btnCancel\",\n                                                                                            control_type=\"Button\")\n                                        cancel_btn.click()\n                                        time.sleep(1)\n                                        newOCT_btn = app['血管内断层成像系统'].child_window(auto_id=\"btnAddOCT\",\n                                                                                            control_type=\"Button\")\n                                        newOCT_btn.click()\n                                        time.sleep(2)\n                                time.sleep(3)\n                common_util.back_patientListPage()\n                patient_list = app['血管内断层成像系统'].child_window(title=\"F_2.Models.PatientInfo\",\n                                                                      control_type=\"DataItem\", found_index=0)\n                patient_list.click_input()\n                time.sleep(2)\n                ok_btn = app['血管内断层成像系统'].child_window(title=\"确定\", auto_id=\"btnOk\", control_type=\"Button\")\n                ok_btn.click()\n                time.sleep(2)\n                with allure.step('选中最后一个数据后，点击导出按钮'):\n                    img_num = app['血管内断层成像系统'].child_window(auto_id=\"lstBox_Date\", control_type=\"List\")\n                    img_num = int(img_num.texts()[0][2])-1\n                    if img_num>5:\n                        for i in range(70):\n                            mouse.scroll(coords=(500, 500), wheel_dist=-10)\n                    check_mark = app['血管内断层成像系统'].child_window(auto_id=\"checkBox\",\n                                                                        control_type=\"CheckBox\",\n                                                                        found_index=img_num)\n    \n                    rect = check_mark.rectangle().mid_point()\n                    mouse.click(coords=(rect.x, rect.y))\n                    time.sleep(1)\n                    export_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                        control_type=\"Text\",\n                                                                        found_index=0)\n                    rect = export_btn.rectangle().mid_point()\n                    mouse.click(coords=(rect.x, rect.y))\n                    time.sleep(1)\n                    next_btn = app['血管内断层成像系统'].child_window(title=\"下一步\",\n                                                                      auto_id=\"btnOutput\",\n                                                                      control_type=\"Button\")\n                    next_btn.click()\n                    time.sleep(1)\n                    app['血管内断层成像系统'].child_window(title=\"导出\", auto_id=\"btnOutput\",\n                                                           control_type=\"Button\").wait(\n                        wait_for='enabled', timeout=100)\n                    time.sleep(1)\n                    out_btn = app['血管内断层成像系统'].child_window(title=\"导出\",\n                                                                     auto_id=\"btnOutput\",\n                                                                     control_type=\"Button\").wait('enabled',timeout=5)\n                    out_btn.click()\n                    for k in range(100):\n                        if k % 2 == 0:\n                            pyautogui.click(500, 500)\n                        else:\n                            pyautogui.click(600, 600)\n                    time.sleep(1)\n                    common_util.screen_shot('截图')\n                    ok_btn = app['提示'].child_window(title=\"确 定\", auto_id=\"OkButton\",\n                                                      control_type=\"Button\").wait(wait_for='exists', timeout=100)\n                    ok_btn.click()\n                    time.sleep(1)\n                    cancel_btn = app['血管内断层成像系统'].child_window(title=\"取消\",\n                                                                        auto_id=\"btnCancel\",\n                                                                        control_type=\"Button\")\n                    cancel_btn.click()\n                    time.sleep(1)\n    \n            disk_list = []\n            for c in string.ascii_uppercase:\n                disk = c + ':'\n                if os.path.isdir(disk):\n                    disk_list.append(disk)\n            for i in range(len(disk_list)):\n                disk_info = win32api.GetVolumeInformation(disk_list[i] + '/')\n                if disk_info[0] == 'BossXU':\n                    usb_adress = disk_list[i] + '/*'\n                    files = glob.glob(usb_adress)\n            export_file = []\n            for i in range(len(files)):\n                if 'FSM_202' in files[i]:\n                    export_file.append(i)\n            with allure.step('导出次数{}'.format(len(export_file))):\n                common_util.add_text('导出次数：{}'.format(len(export_file)))\n        except Exception as e:\n            common_util.add_text(str(e))\n>           assert False\nE           assert False\n\ntestcases\\export\\test_export.py:554: AssertionError","steps":[{"name":"6k:不同转速和距离","time":{"start":1689158585273,"stop":1689158590326,"duration":5053},"status":"broken","statusMessage":"pywinauto.findwindows.ElementNotFoundError: {'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - '血管内光学干涉断层成像系统', Window, 721684>, 'backend': 'uia'}\n","statusTrace":"  File \"D:\\workspace\\pytest-VM1\\testcases\\export\\test_export.py\", line 33, in test_export\n    setting_btn.click_input()\n    ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py\", line 379, in __getattribute__\n    ctrls = self.__resolve_control(self.criteria)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py\", line 261, in __resolve_control\n    raise e.original_exception\n  File \"C:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\timings.py\", line 436, in wait_until_passes\n    func_val = func(*args, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\application.py\", line 222, in __get_ctrl\n    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))\n                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Program Files\\Python311\\Lib\\site-packages\\pywinauto\\findwindows.py\", line 87, in find_element\n    raise ElementNotFoundError(kwargs)\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"stepsCount":0}],"attachments":[{"uid":"7790debfdc9f30cc","name":"{'auto_id': 'btnSetting', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - '血管内光学干涉断层成像系统', Window, 721684>, 'backend': 'uia'}","source":"7790debfdc9f30cc.txt","type":"text/plain","size":0}],"parameters":[],"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"stepsCount":1},"afterStages":[],"labels":[{"name":"feature","value":"导出"},{"name":"tag","value":"test"},{"name":"parentSuite","value":"testcases.export"},{"name":"suite","value":"test_export"},{"name":"subSuite","value":"TestExport"},{"name":"host","value":"DESKTOP-8BNU2EL"},{"name":"thread","value":"1788-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"testcases.export.test_export"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":["test"]},"source":"ff91bd957d23084a.json","parameterValues":[]}